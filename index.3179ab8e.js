import{initializeApp as I}from"https://www.gstatic.com/firebasejs/9.6.3/firebase-app.js";import{getDatabase as w,ref as k,onValue as x}from"https://www.gstatic.com/firebasejs/9.6.3/firebase-database.js";const b=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))p(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&p(a)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function p(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}};b();const f={firebasePath:"station-home",firebaseConfig:{apiKey:"AIzaSyCTVRTgXZTk5WjAMGRtxvFog0R0nElrSUk",authDomain:"weather-station-8e973.firebaseapp.com",databaseURL:"https://weather-station-8e973-default-rtdb.firebaseio.com",projectId:"weather-station-8e973",storageBucket:"weather-station-8e973.appspot.com",messagingSenderId:"270171452446",appId:"1:270171452446:web:1f42aab361155f98336a0f",measurementId:"G-3SLBPRH8D3"}},H=document.getElementById("toggle-theme"),m=document.getElementById("toggle-icon"),g=document.getElementById("toggle-text"),E=document.getElementById("todayText"),h=document.getElementById("banner-install");I(f.firebaseConfig);const v=w(),B=document.getElementById("tempValue"),s=document.getElementById("tempMin"),c=document.getElementById("tempMax"),l=document.getElementById("tempClockMin"),M=document.getElementById("tempClockMax"),S=document.getElementById("humValue"),d=document.getElementById("humMin"),u=document.getElementById("humMax"),y=document.getElementById("humClockMin"),T=document.getElementById("humClockMax"),C=k(v,f.firebasePath),D=new Date,F={weekday:"long",month:"long",day:"numeric"};E.innerHTML=new Intl.DateTimeFormat("es-US",F).format(D);x(C,o=>{const e=o.val(),i={hour:"numeric",minute:"numeric",hourCycle:"h24"};B.innerHTML=e.temperature.value+"<span>\xB0</span>",S.innerHTML=e.humidity.value+"<span>%</span>",l.innerHTML==="00:00"&&(l.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.temperature.clockMin),M.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.temperature.clockMax),y.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.humidity.clockMin),T.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.humidity.clockMax),s.innerHTML=e.temperature.min,c.innerHTML=e.temperature.max,d.innerHTML=e.humidity.min,u.innerHTML=e.humidity.max),s.innerHTML!==e.temperature.min&&(l.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.temperature.clockMin)),c.innerHTML!==e.temperature.max&&(M.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.temperature.clockMax)),d.innerHTML!==e.humidity.min&&(y.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.humidity.clockMin)),u.innerHTML!==e.humidity.max&&(T.innerHTML=new Intl.DateTimeFormat("es-US",i).format(e.humidity.clockMax)),s.innerHTML=e.temperature.min,c.innerHTML=e.temperature.max,d.innerHTML=e.humidity.min,u.innerHTML=e.humidity.max});H.addEventListener("click",()=>{document.body.classList.toggle("dark"),m.src.includes("moon.svg")?(m.src="./icons/sun.svg",g.textContent="Light Mode"):(m.src="./icons/moon.svg",g.textContent="Dark Mode")});let r;window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),r=o,showInstallPromotion(),console.log("'beforeinstallprompt' event was fired.")});h.addEventListener("click",async()=>{L(),r.prompt();const{outcome:o}=await r.userChoice;console.log(`User response to the install prompt: ${o}`),r=null});window.addEventListener("appinstalled",()=>{L(),r=null,console.log("PWA was installed")});function L(){h.classList.add("hidden")}window.addEventListener("load",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(o=>{console.log("Service Worker registered!")}).catch(o=>{console.log("Service Worker registration failed: ",o)})});
